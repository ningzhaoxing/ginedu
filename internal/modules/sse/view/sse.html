<!DOCTYPE html>
<html>
<head>
    <title>SSE test</title>


    <script type="text/javascript">
        window.addEventListener("DOMContentLoaded", function () {
            var evsrc = new EventSource("/sse");
            evsrc.onmessage = function (ev) {
                document.getElementById("log")
                    .insertAdjacentHTML("beforeend", "<li>" + ev.data + "</li>");
            }
            evsrc.onerror = function (ev) {
                console.log("readyState = " + ev.currentTarget.readyState);
            }
            
            document.getElementById("close").addEventListener("click",function (e) {
                console.log("关闭")
                evsrc.close()
            })
        })
    </script>
</head>
<body>
<h1>SSE test</h1>
<button id="close">关闭</button>
<div>
    <ul id="log">
    </ul>
</div>
</body>
</html>
